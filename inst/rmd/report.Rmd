---
params:
  new_bn: NA
  old_bn: NA
  new_call_text: NA
  old_call_text: NA
  file_name : NA
  session : NA
title: "Benchmark report `r params$file_name`"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  beamer_presentation
---

```{r include=F}
knitr::opts_chunk$set(fig.height = 2.5,dpi=49,out.width = "100%")
knitr::opts_knit$set(global.par = TRUE)
hfserie <- model.list(params$new_bn)$hfserie
hfserie <- hfserie[,colnames(hfserie) != "constant"]

presets_list_fun <- function(hfserie,lfserie,...) {
  lapply(1L:6L,function(type) {
      in_sample(
        twoStepsBenchmark(hfserie,lfserie,
                          include.differenciation = presets$include.differenciation[type],
                          include.rho = presets$include.rho[type],
                          set.const = presets$set.const[[type]])
      )
  })
}
presets_list <- presets_list_fun(hfserie,model.list(params$new_bn)$lfserie)
```

```{r include=FALSE}
graphpar <- par(mar = c(1,0,0,0))
```

```{r include=F}
setProgress(0.1, "Rendering Rmd","Page 1/6",session=params$session)
```

# Presets

:::: {.columns}

::: {.column width="50%"}

**Before**

Model 1 (*differences --- with constant*)

```{r echo=FALSE}
plot(presets_list[[1]])
```

Model 3 (*levels --- with constant*)

```{r echo=FALSE}
plot(presets_list[[3]])
```

Model 5 (*levels --- without constant*)

```{r echo=FALSE}
plot(presets_list[[5]])
```

:::

::: {.column width="50%"}

**After**

Model 2 (*differences --- without constant*)

```{r echo=FALSE}
plot(presets_list[[2]])
```

Model 4 (*autocorrelated levels --- with constant*)

```{r echo=FALSE}
plot(presets_list[[4]])
```

Model 6 (*autocorrelated levels --- without constant*)

```{r echo=FALSE}
plot(presets_list[[6]])
```

:::

::::

```{r include=F}
setProgress(0.3, "Rendering Rmd","Page 2/6",session=params$session)
```

# Benchmarks

:::: {.columns}

::: {.column width="50%"}

**Before**

```{r echo=FALSE,comment="\t"}
cat(params$old_call_text)
```

:::


::: {.column width="50%"}

**After**

```{r echo=FALSE,comment="\t"}
cat(params$new_call_text)
```

:::

::::

:::: {.columns}

::: {.column width="50%"}

```{r echo=FALSE}
plot(params$old_bn)
```

:::

::: {.column width="50%"}

```{r echo=FALSE}
plot(params$new_bn)
```

:::

::::

```{r include=F}
setProgress(0.4, "Rendering Rmd","Page 3/6",session=params$session)
```

# In-sample predictions

:::: {.columns}

::: {.column width="50%"}

**Before**

```{r echo=FALSE}
plot(in_sample(params$old_bn,type="levels"))
plot(in_sample(params$old_bn,type="changes"))
```

:::

::: {.column width="50%"}

**After**

```{r echo=FALSE}
plot(in_sample(params$new_bn,type="levels"))
plot(in_sample(params$new_bn,type="changes"))
```

:::

::::

```{r include=F}
setProgress(0.5, "Rendering Rmd","Page 4/6",session=params$session)
```

# Summary

:::: {.columns}

::: {.column width="50%"}

**Before**

```{r echo=FALSE}
print(summary(params$old_bn),call=FALSE)
```

:::

::: {.column width="50%"}

**After**

```{r echo=FALSE}
print(summary(params$new_bn),call=FALSE)
```

:::

::::

```{r include=F}
setProgress(0.6, "Rendering Rmd","Page 5/6",session=params$session)
```

# Comparison with indicator

:::: {.columns}

::: {.column width="100%"}

```{r echo=FALSE,fig.width = 14}
plot(in_dicator(params$new_bn,type="levels-rebased"))
plot(in_dicator(params$new_bn,type="changes"))
plot(in_dicator(params$new_bn,type="contributions"))
```

:::

::::

```{r include=F}
setProgress(0.8, "Rendering Rmd","Page 6/6",session=params$session)
```

# Revisions

:::: {.columns}

::: {.column width="100%"}

```{r echo=FALSE,fig.width=14}
plot(in_revisions(params$new_bn,params$old_bn,type="levels"))
plot(in_revisions(params$new_bn,params$old_bn,type="changes"))
plot(in_revisions(params$new_bn,params$old_bn,type="contributions"))
```

```{r include=F}
setProgress(0.9, "Producing HTML","",session=params$session)
par(graphpar)
```

:::

::::